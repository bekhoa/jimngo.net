function search(){getClientInputs(),$.ajax({url:`https://h.api.crmls.org/RESO/OData/Property?$filter=(StandardStatus eq 'A')and(PropertyType eq '${property_type}')and(PropertySubType eq '${property_sub_type}')and(City eq '${city}')and(BathroomsTotalInteger ge ${bath})and(BedroomsTotal ge ${bed})and(ListPrice ge ${min_price})and(ListPrice le ${max_price})&$select=${select}&$orderby=${orderby}&$expand=${expand}`,method:"GET",headers:{Accept:"application/json",Authorization:"Bearer "+token}}).done(function(i){listings=i.value,updateCities(),$("#searchCity").html(`${city} Real Estate<br/>Homes For Sale`),$("#listingCount").html(`${listings.length} Listings`),$("#records").empty(),$("#listing-indexed-pages").empty(),renderlistingPages()})}function renderlistingPages(){var i=0,e=0,t=12;for(i=0;i<listings.length;i+=t){var n=listings.slice(i,i+t);listingPages.push(n);var s=`<button onclick="displayIndexedListingPage(${e})">${e+1}</button>`;$("#listing-indexed-pages").append(s),e++}displayListings(0)}function displayListings(i){$("#records").empty();for(var e=listingPages[i],t=0;t<e.length;t++){listing=e[t],updateListings(),ListingId=listing.ListingId,listingMedias=listing.Media,console.log(listingMedias),firstListingMedia=listingMedias[0],n=firstListingMedia.MediaURL,console.log(n);var n=n.slice(0,4)+"s"+n.slice(4);console.log(n);var s=`\n            <div class='col-4 col-s-6'>\n                <div class='border'>\n                    <img class="photo-card" src="${n}" id="${ListingId}" onclick="singleListing('${ListingId}')">\n                    <div class="inputTitleContainer">\n                        <div class="inputTitle font-large">$${listing.ListPrice}</div>\n                        <div class="inputValue">${listing.MajorChangeType}</div>\n                    </div>\n                    <div>&ensp;• Listing ID: ${listing.ListingId}</div>\n                    <div>&ensp;• ${listing.BedroomsTotal} Beds • ${listing.BathroomsTotalInteger} Baths • ${listing.LivingArea} sqft</div>\n                    <div>&ensp;${listing.StreetNumberNumeric} ${listing.StreetName} ${listing.StreetSuffix}, ${listing.City} CA ${listing.PostalCode}</div>\n                </div>\n            </div>\n        `;$("#records").append(s)}}function https(){String.prototype.splice=function(i,e,t){return this.slice(0,i)+t+this.slice(i+Math.abs(e))};var i="foo baz".splice(4,0,"bar ");document.body.innerHTML=i}function displayIndexedListingPage(i){displayListings(i),document.getElementById("searchCity").scrollIntoView()}function singleListing(i){clearTimeout(slideShow),$("#photo-slide").empty(),$("#remarks").empty(),document.getElementById("listing-indexed-pages").scrollIntoView();var e=listings.find(e=>e.ListingId===i);console.log(e);var t=e.Media;console.log(t);for(var n=0;n<t.length;n++){var s=`\n        <div class='mySlides fade'>\n            <img  src="${t[n].MediaURL}" class='photo-big'>  \n        </div>    \n        `;$("#photo-slide").append(s)}slides=document.getElementsByClassName("mySlides"),slideIndex=0,displayPhoto();var o=`\n    <div class="inputTitleContainer">\n        <div class="inputTitle font-large">$${e.ListPrice}</div>\n        <div class="inputValue">${e.MajorChangeType}</div>\n    </div>\n    <div>&ensp;• Listing ID: ${e.ListingId}</div>\n    <div>&ensp;• ${e.BedroomsTotal} Beds • ${e.BathroomsTotalInteger} Baths • ${e.LivingArea} sqft</div>\n    <div>&ensp;${e.StreetNumberNumeric} ${e.StreetName} ${e.StreetSuffix}, ${e.City} CA ${e.PostalCode}</div><br/>\n\n    ${e.PublicRemarks}</div>\n    `;$("#remarks").append(o)}function displayPhoto(){for(var i=0;i<slides.length;i++)slides[i].style.display="none";slideIndex++,slideIndex>slides.length&&(slideIndex=1),slides[slideIndex-1].style.display="block",slideShow=setTimeout(displayPhoto,3e3)}function findListing(i){var e=listings.find(e=>e.ListingId===i);console.log(e)}function updateCities(){"ONT"===city&&(city="Ontario CA"),"CH"===city&&(city="Chino CA"),"CHH"===city&&(city="Chino Hills CA"),"COR"===city&&(city="Corona"),"EVAL"===city&&(city="Eastvale"),"RVSD"===city&&(city="Riverside")}function updateListings(){"A"===listing.StandardStatus&&(listing.StandardStatus="Active"),"Resi"===listing.PropertyType&&(listing.PropertyType="Residential"),"SFR"===listing.PropertySubType&&(listing.PropertySubType="Single Family"),"TWNHS"===listing.PropertySubType&&(listing.PropertySubType="Townhouse"),"CONDO"===listing.PropertySubType&&(listing.PropertySubType="Condominium"),"ONT"===listing.City&&(listing.City="Ontario"),"CH"===listing.City&&(listing.City="Chino"),"CHH"===listing.City&&(listing.City="Chino Hills"),"COR"===listing.City&&(listing.City="Corona"),"EVAL"===listing.City&&(listing.City="Eastvale"),"RVSD"===listing.City&&(listing.City="Riverside"),"PRICECHG"===listing.MajorChangeType&&(listing.MajorChangeType="Price Change"),"NEWLIST"===listing.MajorChangeType&&(listing.MajorChangeType="New Listing"),"BOM"===listing.MajorChangeType&&(listing.MajorChangeType="Back On Market")}function sort_by_key(i,e){return i.sort(function(i,t){var n=i[e],s=t[e];return n<s?-1:n>s?1:0})}function getClientInputs(){getPropertyType(),getPropertySubType(),getCity(),getMinPrice(),getMaxPrice(),getBed(),getBath()}function getPropertyType(){property_type=document.getElementById("property_type").value}function getPropertySubType(){property_sub_type=document.getElementById("property_sub_type").value}function getCity(){city=document.getElementById("city").value}function getMinPrice(){min_price=document.getElementById("min_price").value}function getMaxPrice(){max_price=document.getElementById("max_price").value}function getBed(){bed=document.getElementById("bed").value}function getBath(){bath=document.getElementById("bath").value}function getShortName(i,e){var t=e.find(e=>e.longName===i);console.log(t);var n=t.shortName;console.log(" Abbreviation is "+n)}function getLongtName(i,e){var t=e.find(e=>e.shortName===i);console.log(t);var n=t.longName;console.log(" Abbreviation is "+n)}const connect={url:"https://op.api.crmls.org/identity/connect/token",method:"POST",timeout:0,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{client_id:"JIMNGO",client_secret:"2@jCM@z2",scope:"ODataApi",grant_type:"client_credentials"}},select="PropertyType, PropertySubType, StandardStatus, ListingId, ListPrice, OriginalListPrice, PublicRemarks, DaysOnMarket, StreetNumberNumeric, StreetName, StreetSuffix, City, PostalCode, BedroomsTotal, BathroomsTotalInteger, LivingArea, Cooling, Heating, AssociationFee, YearBuilt, DaysOnMarket, MajorChangeType, PhotosCount",orderby="ListPrice",expand="Media($select=MediaURL)";var listingId,slideShow,listings=[],listingPages=[],listing=[],picturesForListing=[];$.ajax(connect).done(function(i){token=i.access_token,search()});const names=[{shortName:"ONT",longName:"Ontario"},{shortName:"CH",longName:"Chino"},{shortName:"CHH",longName:"Chino Hills"},{shortName:"COR",longName:"Corona"},{shortName:"RVSD",longName:"Riverside"},{shortName:"EVAL",longName:"Eastvale"},{shortName:"Resi",longName:"Residential"}];